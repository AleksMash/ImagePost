# Публикация снимков космоса в Telegram-канале

Скрипт позволяет скачивать фото космоса через API SpaceX 
(https://github.com/r-spacex/SpaceX-API/tree/master/docs/launches/v5) и NASA (https://api.nasa.gov/) и затем запустить их публикацию
в случайном порядке в Telegram-канале посредством Telegram-бота с заданным интервалом.

### Как установить

Python3 должен быть уже установлен.
Затем используйте `pip` (или `pip3`, есть конфликт с Python2) для установки зависимостей:

```
pip install -r requirements.txt
```

Для запуска необходимо создать файл .env в домашней директории проекта, содержащий значения следующих переменных 
окружения:

- NASA_TOKEN - NASA API ключ (см. https://api.nasa.gov/)
- TG_BOT_TOKEN - токен Telegram - бота, через которого будет производиться публикация в Telegram-канале (бот должен быть включен
в число администраторов канала)
- TG_CHANNEL - ссылка на Telegram-канал (например @MyChannel)
- PUBLISHING_INTERVAL - интервал публикации фотографий ботом в часах.

### fetch_nasa_apod_pictures.py

Скачивает 15 случайных фотографий дня с API NASA (https://api.nasa.gov/planetary/apod) и сохраняет их в папку **images**

Запуск:

```python fetch_nasa_apod_pictures.py```

### fetch_nasa_epic_pictures.py

Скачивает указанное в аргументе число (7 по умолчанию) фотографий земли с API NASA (https://api.nasa.gov/EPIC/api/natural/images) и сохраняет их в папку **images**

Запуск:

```python fetch_nasa_epic_pictures.py [максимальное число изображений (7 по умолчанию)]```

### fetch_spacex_images.py

Скачивает фотографии указанного ID запуска в папку **images** с API SpaceX (https://github.com/r-spacex/SpaceX-API/blob/master/docs/launches/v5/one.md).

Запуск:

```python fetch_spacex_images.py [ID]```

где ID - ID запуска, фотографии которого необходимо скачать.
В случае, если фото заданного запуска отсутствуют, скрипт выбросит ошибку.
В случае если ID запуска не будет указан скрипт попытается загрузить фото последнего запуска. При отсутствии фотографий последнего
запуска скрипт выдаст ошибку.

### publish_cycle.py

Выполняет посредством Telegram-бота публикацию фотографий из папки **images** (или переданной в виде аргумента
при вызове скрипта) в Telegram-канале, заданном в переменной окружения TG_CHANNEL.
Токен бота указывается в переменной окружения TG_BOT_TOKEN. Бот должен быть администратором канала. Фотографии выбираются хаотично
и публикуются циклически с интервалом, указанном в переменной окружения PUBLISHING_INTERVAL (в часах) или, если эта переменная окружения не указана, с интервалом указанном в качестве
аргумента при запуске скрипта (см. ниже). В случае, если и переменная PUBLISHING_INTERVAL и аргумента скрипта не указаны, значение интервала 
по умолчанию - 4 часа. После того как будут опубликованы все фотографии из папки **images** порядок их снова меняется и публикация запускается вновь.

Запуск:

```python publish_cycle.py [интервал] [путь к папке с изображениями]```

где `интервал` - интервал публикации в часах. 

### publish_one.py

Публикует конкретное изображение из папки **images** (или переданной в виде аргумента
при вызове скрипта)  в Telegram-канале, заданном в переменной окружения TG_CHANNEL.
Токен бота указывается в переменной окружения TG_BOT_TOKEN. Бот должен быть администратором канала.  Файл изображения из папки **images**
указаывается в качестве аргумента при вызове скрипта. Если изображения не был указан, будет опубликована случайная фотография. Если в папке **images** нет фотографий скрипт выбрасывает
ошибку.

Вызов: 

```python publish_cycle.py [файл] [путь к папке с изображениями]```

### common.py

Модуль содержит функции, используемые другими модулями.
